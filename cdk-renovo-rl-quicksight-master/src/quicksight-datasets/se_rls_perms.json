{
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Description" : "Generated by AWS QuickSight for export-seperms-latest started at 2025-03-26 17:09:03 UTC",
  "Parameters": {
    "RenovoLiveEnv": {
      "Type": "String",
      "Description": "RenovoLive Environment"
    },
    "Database": {
      "Type": "String",
      "Description": "Database name"
    },
    "DataSourceArn": {
      "Type": "String",
      "Description": "Data source ARN"
    },
    "FolderArn": {
      "Type": "String",
      "Description": "Folder ARN"
    },
    "ManagingPrincipal": {
      "Type": "String",
      "Description": "Managing principal"
    }
  },
  "Resources" : {
    "09e0f13631eb40119e0b47A6D3" : {
      "Properties" : {
        "UseAs": "RLS_RULES",
        "AwsAccountId" : {
          "Fn::Sub" : "${AWS::AccountId}"
        },
        "DataSetId": {
          "Fn::Sub": "${RenovoLiveEnv}_${Database}_vRlsServiceEvents"
        },
        "Name": {
          "Fn::Sub": "${RenovoLiveEnv}_${Database}_vRlsServiceEvents"
        },
        "Permissions": [{
          "Actions": [
            "quicksight:DescribeDataSet",
            "quicksight:DescribeDataSetPermissions",
            "quicksight:PassDataSet",
            "quicksight:DescribeIngestion",
            "quicksight:ListIngestions",
            "quicksight:UpdateDataSet",
            "quicksight:DeleteDataSet",
            "quicksight:CreateIngestion",
            "quicksight:CancelIngestion",
            "quicksight:UpdateDataSetPermissions"
          ],
            "Principal": {
            "Fn::Sub": "${ManagingPrincipal}"
          }
        }],
        "FolderArns": [
          {
            "Fn::Sub": "${FolderArn}"
          }
        ],
        "DataSetUsageConfiguration" : {
          "DisableUseAsDirectQuerySource" : false,
          "DisableUseAsImportedSource" : false
        },
        "FieldFolders" : { },
        "ImportMode" : "DIRECT_QUERY",
        "LogicalTableMap" : {
          "a62cc33d-9cdf-4b7f-bf48-80e91dff8cc6" : {
            "Alias" : "Query vRlsServiceEvents and Union Dev Access Override",
            "DataTransforms" : [ {
              "TagColumnOperation" : {
                "ColumnName" : "region_id",
                "Tags" : [ {
                  "ColumnGeographicRole" : "STATE"
                } ]
              }
            }, {
              "ProjectOperation" : {
                "ProjectedColumns" : [ "UserName", "GroupName", "facility_id", "system_id", "client_id", "region_id" ]
              }
            } ],
            "Source" : {
              "PhysicalTableId" : "c6e72601-482c-419b-97c2-ba9443e58fac"
            }
          }
        },
        "PhysicalTableMap" : {
          "c6e72601-482c-419b-97c2-ba9443e58fac" : {
            "CustomSql" : {
              "Columns" : [ {
                "Name" : "UserName",
                "Type" : "STRING"
              }, {
                "Name" : "GroupName",
                "Type" : "STRING"
              }, {
                "Name" : "facility_id",
                "Type" : "STRING"
              }, {
                "Name" : "system_id",
                "Type" : "STRING"
              }, {
                "Name" : "client_id",
                "Type" : "STRING"
              }, {
                "Name" : "region_id",
                "Type" : "STRING"
              } ],
              "DataSourceArn": {
                "Fn::Sub": "${DataSourceArn}"
              },
              "Name" : "Query vRlsServiceEvents and Union Dev Access Override",
              "SqlQuery": {
                "Fn::Sub": "SELECT\n  TRIM(STR(userID)) AS UserName,\n  null AS GroupName,\n  facilityIDs AS facility_id,\n  systemIDs AS system_id,\n  clientIDs AS client_id,\n  regionIDs AS region_id\nFROM [${Database}].[qs].[vRlsServiceEvents]\nUNION\nSELECT\n  null AS UserName,\n  'RenovoLiveDevelopers' AS GroupName,\n  null AS facility_id,\n  null AS system_id,\n  null AS client_id,\n  null AS region_id"
              }
            }
          }
        }
      },
      "Type" : "AWS::QuickSight::DataSet"
    }
  }
}